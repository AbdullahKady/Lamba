<!-- Page Content -->
<div  class="container" *ngIf="isInitialized">

  <div class="row">

    <!-- Post Content Column -->
    <div class="col-lg-8">

      <!-- Title -->
      <h1 class="mt-4">{{article.title}}</h1>

      <!-- Author -->
      <p class="lead">
        by
        <a style="cursor: pointer;" [routerLink]="['/profile',article.owner_id]">{{author}}</a>
      </p>

      <!-- Date/Time -->
      <p align="right">Posted on {{article.createdAt | date}}</p>

      <hr>

      <!-- Preview Image -->
      <!-- TODO: "Featurez" Will we add a thumbnail option with a default while posting? -->
      <img class="img-fluid rounded" src="http://placehold.it/900x300" alt="">

      <hr>

      <!-- Post Content -->
      <div [innerHTML]="article.content | safeHtml">
      </div>

      <hr>

      <!-- Comments Form -->
      <div class="card my-4">
        <h5 class="card-header">Leave a Comment:</h5>
        <div class="card-body">
          <form>
            <div class="form-group">
              <textarea class="form-control" [(ngModel)]="commentContent" name="comment" placeholder="Comment"  rows="3"></textarea>
            </div>
            <button type="submit" (click)="comment()" class="btn btn-primary">Submit</button>
          </form>
        </div>
      </div>

      <!-- Single Comment -->
      <ng-container *ngFor="let comment of comments | paginate: { itemsPerPage: 4, currentPage: p };let i = index">
      <div class="media mb-4">
        <img class="d-flex mr-3 rounded-circle" src="http://placehold.it/50x50" alt="">
        <div class="media-body">
          <h6>
          <a style="cursor: pointer;" [routerLink]="['/profile',comment.commenter]">
            {{comment.commenter.name.firstName}} {{comment.commenter.name.lastName}}
          </a>
          </h6>
          <p>{{comment.comment_content}}</p>
          <button class="btn btn-link" (click)="replies[i].showReply = true">reply</button>
          <div class="card my-4" *ngIf="replies[i].showReply">
            <h5 class="card-header">Leave a Reply:</h5>
            <div class="card-body">
              <form>
                <div class="form-group">
                  <textarea class="form-control" [(ngModel)]="replies[i].replyContent" name="Reply" placeholder="Reply"  rows="3"></textarea>
                </div>
                <button type="submit" (click)="reply(i,comment._id,replies[i].replyContent)" class="btn btn-primary">Submit</button>
              </form>
            </div>
          </div>
          <div class="media mt-4" *ngFor="let reply of comment.replies">
            <img class="d-flex mr-3 rounded-circle" src="http://placehold.it/50x50" alt="">
            <div class="media-body">
              <h6>
                <a style="cursor: pointer;" [routerLink]="['/profile',reply.replier]">
                  {{reply.replier.name.firstName}} {{reply.replier.name.lastName}}  </a>
              </h6>
              {{reply.reply_content}}
            </div>
          </div>
        </div>

      </div>
      </ng-container>
      <pagination-controls (pageChange)="p = $event"></pagination-controls>


      <!-- Comment with nested comments -->


    </div>

    <!-- Sidebar Widgets Column -->
    <div class="col-md-4">
      <!-- Categories Widget -->
      <div class="card my-4">
        <h5 class="card-header">Tags</h5>
        <div class="card-body">
          <div class="row">
            <div class="col-lg-6">
              <ul class="list-unstyled mb-0">
                <li>
                  <a href="#">Web Design</a>
                </li>
                <li>
                  <a href="#">HTML</a>
                </li>
                <li>
                  <a href="#">Freebies</a>
                </li>
              </ul>
            </div>
            <div class="col-lg-6">
              <ul class="list-unstyled mb-0">
                <li>
                  <a href="#">JavaScript</a>
                </li>
                <li>
                  <a href="#">CSS</a>
                </li>
                <li>
                  <a href="#">Tutorials</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Side Widget -->
      <div class="card my-4">
        <h5 class="card-header">Rating</h5>
        <div class="card-body">
          <div class="row">
            <div class="col-lg-6">
              <button class="btn btn-primary" (click)="upvote(article._id)">Upvote ({{article.upvoters.length}})</button>
            </div>
            <div class="col-lg-6">
              <button class="btn btn-danger" (click)="downvote(article._id)">Downvote ({{article.downvoters.length}})</button>
            </div>
          </div>
        </div>
      </div>

    </div>

  </div>
  <!-- /.row -->

</div>
<!-- /.container -->
